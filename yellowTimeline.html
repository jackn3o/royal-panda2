<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link href="css/reset.css" rel="stylesheet" type="text/css">
    <link href="css/style.css" rel="stylesheet" type="text/css">
    <link href="css/animate.css" rel="stylesheet" type="text/css">
    <link href="css/bootstrap-grid.css" rel="stylesheet" type="text/css">
    <link href="css/base.css" rel="stylesheet" type="text/css">
    <link href="css/product-detail.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU"
        crossorigin="anonymous">
    <script src="lib/jquery-3.3.1.slim.min.js"></script>
</head>

<body>
    <div class="rp_swing_box">
        <figure class="suo_animation">
            <img id="js_suoMenuTrigger" class="rp_suo" src="img/base/suo.png">
        </figure>
        <figure id="js_suo_menu" class="rp_suo_menu">
            <div class="suo_menu_icon huiyuan mr-2"></div>
            <div class="suo_menu_icon search"></div>
            <div class="suo_menu_icon cart"></div>
            <div class="suo_menu_icon kefu ml-2"></div>
            <div style="flex:1;"></div>
            <div class="suo_menu_icon feedback"></div>
        </figure>
    </div>
    <div id="js_header" class="rp_header white--bg">
        <div class="rp_logo">
            <img src="img/base/royal-panda.png">
        </div>
        <div id="js_pandaImage" class="rp_panda_logo"></div>
        <div id="js_category_box" class="rp_category_box">
            <a href="#" class="rp_btn image_btn flat large active js_category_trigger">
                家居用品
                <div class="image_holder">
                    <img src="./img/base/jiajuyongpin.png">
                </div>
            </a>
            <a href="./product2.html" class="rp_btn image_btn flat large js_category_trigger">
                玩具学习
                <div class="image_holder">
                    <img src="./img/base/wanjuxuexi.png">
                </div>
            </a>
            <a href="./product3.html" class="rp_btn image_btn flat large js_category_trigger">
                出行工具
                <div class="image_holder">
                    <img src="./img/base/chuxinggongju.png">
                </div>
            </a>
            <a href="./product4.html" class="rp_btn image_btn flat large js_category_trigger">
                洗护保洁
                <div class="image_holder">
                    <img src="./img/base/xijiebaohu.png">
                </div>
            </a>
            <a href="./product5.html" class="rp_btn image_btn flat large js_category_trigger">
                电器安防
                <div class="image_holder">
                    <img src="./img/base/dianqianfang.png">
                </div>
            </a>
            <a href="./product6.html" class="rp_btn image_btn flat large js_category_trigger">
                尿布服饰
                <div class="image_holder">
                    <img src="./img/base/niaobufushi.png">
                </div>
            </a>
            <a href="./product7.html" class="rp_btn image_btn flat large js_category_trigger">
                喂养餐具
                <div class="image_holder">
                    <img src="./img/base/weishicanju.png">
                </div>
            </a>
            <a href="./product8.html" class="rp_btn image_btn flat large js_category_trigger">
                奶粉辅食
                <div class="image_holder">
                    <img src="./img/base/naifenfushi.png">
                </div>
            </a>
        </div>
    </div>
    <div class="inner_body">
        <div class="container-fluid mt-3">
            <!--  products -->
            <div id="js_overflow_box" class="overflow_x_container">
                <div class="overflow_overlay"></div>
                <input type="hidden" id="js_overflowItemCount" value="4" />
                <button type="button" id="js_btn_left" class="rp_btn btn_left" style="left:0;">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button type="button" id="js_btn_right" class="rp_btn btn_right" style="right:0;">
                    <i class="fas fa-chevron-right"></i>
                </button>
                <div id="js_product_list_box" class="slider product_detail_slider">
                    <div class="empty_placeholder"></div>
                    <div class="rp_product_detail_box wide js_product_detail_box active">
                        <div class="rp_card flat transparent flex-sm-fill">
                            <div class="rp_card--media">
                                <img class="media" src="img/product-detail/p1.png">
                                <!-- <div class="dot" data-text="可搭配不同的配件" data-tooltip="left" style="left: 16%; top: 27%;"></div>
                                <div class="dot" style="left:23%; top: 60%;"></div>
                                <div class="dot" style="right: 23%; top: 38%;"></div>
                                <div class="dot" style="right: 25%; bottom: 13%;"></div> -->
                            </div>
                        </div>
                    </div>
                    <div class="rp_product_detail_box wide js_product_detail_box">
                        <div class="rp_card flat transparent flex-sm-fill">
                            <div class="rp_card--media">
                                <img class="media" src="img/product-detail/p2.png">
                            </div>
                        </div>
                    </div>
                    <div class="rp_product_detail_box wide js_product_detail_box">
                        <div class="rp_card flat transparent flex-sm-fill">
                            <div class="rp_card--media">
                                <img class="media" src="img/product-detail/p3.png">
                            </div>
                        </div>
                    </div>
                    <div class="rp_product_detail_box wide js_product_detail_box">
                        <div class="rp_card flat transparent flex-sm-fill">
                            <div class="rp_card--media">
                                <img class="media" src="img/product-detail/p4.png">
                            </div>
                        </div>
                    </div>
                    <div class="empty_placeholder"></div>
                </div>

                <div id="js_product_description_box" style="position: absolute;bottom:-7rem; width:100%;" class="rp_product_description_box">
                    <div class="row no-gutters">
                        <div class="product_title">
                            月亮湾/mima
                        </div>
                        <div style="font-weight: 500; font-size: 1.8rem; flex:1;"> [西班牙进口] Mima-MoonII可调档高端婴童喂养餐椅</div>
                        <div class="product_price">
                            <div>238 元</div>
                            <button type="button" id="js_more_button" class="rp_btn rp_btn--icon more_button">
                                <i class="fas fa-angle-up grey--text"></i>
                            </button>
                        </div>
                    </div>
                    <div style="flex:1" class="rp_product_spec_box row no-gutters justify-content-between">
                        <div style="width: 12rem;"></div>
                        <div style="flex: 1;" class="row justify-content-between flex-column">
                            <div>
                                <div>产品品牌</div>
                                <div>月亮湾/mima</div>
                                <div>原产地</div>
                                <div>西班牙</div>
                                <div>材质</div>
                                <div>组件材质</div>
                                <div>铝管、铁管、塑胶、气压棒</div>
                                <div>产品重量</div>
                                <div>整体：10.5KG承重：45KG</div>
                            </div>
                            <div>
                                <div>
                                    产品特点
                                </div>
                                <div>
                                    <div>
                                        1、安全稳重不易倒
                                    </div>
                                    <div>
                                        2、时尚高端扩展性强
                                    </div>
                                    <div>
                                        3、含脚踏板、配件齐全
                                    </div>
                                </div>
                                <div>
                                    规格尺寸
                                </div>
                                <div>
                                    产品尺寸 | 长*宽*高
                                    面对餐椅：55*65*119.5CM
                                    餐盘可调节高度区域=71CM~89CM
                                </div>
                                <div>
                                    规格尺寸
                                </div>
                                <div>
                                    产品尺寸 | 长*宽*高
                                    面对餐椅：55*65*119.5CM
                                </div>
                                <div>
                                    颜色分类
                                </div>
                                <div>
                                    炫酷黑/360度调整
                                </div>
                            </div>
                            <div class="product_price"></div>
                        </div>
                    </div>
                    <div style="width:100%" class="row justify-content-around mt-3">
                        <button type="button" class="rp_btn outline rp_btn--icon primary large">
                            <i class="fas fa-angle-left grey--text"></i>
                        </button>
                        <button type="button" class="rp_btn outline rp_btn--icon primary large">
                            <i class="fas fa-angle-left grey--text"></i>
                        </button>
                        <button type="button" class="rp_btn outline rp_btn--icon primary large">
                            <i class="fas fa-angle-left grey--text"></i>
                        </button>
                        <button type="button" class="rp_btn outline rp_btn--icon primary large">
                            <i class="fas fa-angle-left grey--text"></i>
                        </button>
                        <button type="button" class="rp_btn outline rp_btn--icon primary large">
                            <i class="fas fa-angle-left grey--text"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

<script>
    'use strict';
    var el_header = document.querySelector('#js_header'),
        el_productListBox = document.querySelector('#js_product_list_box'),
        el_productDetails = document.querySelectorAll('.js_product_detail_box'),
        el_moreButton = document.querySelector('#js_more_button'),
        el_itemCountHiddenField = document.querySelector('#js_overflowItemCount'),
        el_leftButton = document.querySelector('#js_btn_left'),
        el_rightButton = document.querySelector('#js_btn_right'),
        nb_itemIndex = 1,
        nb_itemCount = 0;

    var fn_scrollTo = function (element, scrollPixels, duration) {
        var scrollPos = element.scrollLeft;
        // Condition to check if scrolling is required
        if (
            !(
                (scrollPos === 0 || scrollPixels > 0) &&
                (element.clientWidth + scrollPos === element.scrollWidth || scrollPixels < 0)
            )
        ) {
            // Get the start timestamp
            var startTime = 'now' in window.performance ? performance.now() : new Date().getTime();
            var scroll = function (timestamp) {
                //Calculate the timeelapsed
                var timeElapsed = timestamp - startTime;
                //Calculate progress
                var progress = Math.min(timeElapsed / duration, 1);
                //Set the scrolleft
                element.scrollLeft = scrollPos + scrollPixels * progress;
                //Check if elapsed time is less then duration then call the requestAnimation, otherwise exit
                if (timeElapsed < duration) {
                    //Request for animation
                    window.requestAnimationFrame(scroll);
                } else {
                    return;
                }
            }

            //Call requestAnimationFrame on scroll function first time
            window.requestAnimationFrame(scroll);

            fn_setIndex();
        }
    };

    var fn_swipeLeft = function () {
        fn_scrollTo(el_productListBox, -fn_getSlidingWidth(false), 600);
    };

    var fn_swipeRight = function () {
        fn_scrollTo(el_productListBox, fn_getSlidingWidth(true), 600);
    };

    var fn_getSlidingWidth = function (isNext) {
        var el_currentActive = document.querySelector('.js_product_detail_box.active'),
            el_nextActive = null;

        if (isNext) {
            el_nextActive = el_currentActive.nextElementSibling;
        } else {
            el_nextActive = el_currentActive.previousElementSibling;
        }

        $(el_currentActive).removeClass('active');
        $(el_nextActive).addClass('active');

        var nb_scrollTo = 0;
        if (el_currentActive.clientWidth) {
            nb_scrollTo = el_currentActive.clientWidth;
        }

        return nb_scrollTo;
    }

    $(el_leftButton).on('click', function () {
        fn_swipeLeft();
    });

    $(el_rightButton).on('click', function () {
        fn_swipeRight();
    });


    $(el_moreButton).on('click', function () {
        var el_overflowBox = document.querySelector('#js_overflow_box');
        // var el_descriptionBox = document.querySelector('#js_product_description_box');
        $(el_overflowBox).addClass('float');
        // $(el_descriptionBox).addClass('float');
    });

    $(el_productListBox).on('click', '.js_product_detail_box', function () {
        var el_selectedDetail = this,
            el_previousActive = el_productListBox.querySelector('.js_product_detail_box.active');

        $(el_productDetails).removeClass('active');
        $(el_selectedDetail).addClass('active');


        var nb_scrollTo = 0;
        if (el_selectedDetail.offsetLeft && el_previousActive.offsetLeft) {
            nb_scrollTo = el_selectedDetail.offsetLeft - el_previousActive.offsetLeft
        }

        fn_scrollTo(el_productListBox, nb_scrollTo, 600);
    });

    var fn_setIndex = function () {
        var el_activeItem = el_productListBox.querySelector('.js_product_detail_box.active'),
            arr_nodes = Array.prototype.slice.call(el_productListBox.children);
        nb_itemIndex = arr_nodes.indexOf(el_activeItem) || 1;

        if (nb_itemIndex > nb_itemCount - 1) {
            $(el_rightButton).addClass('disabled')
        } else if (nb_itemIndex <= 1) {
            $(el_leftButton).addClass('disabled')
        } else {
            $(el_leftButton).removeClass('disabled')
            $(el_rightButton).removeClass('disabled')
        }
    };

    var fn_init = function () {
        var el_currentActive = document.querySelector('.js_product_detail_box.active'),
            nb_scrollTo = 0;

        nb_itemCount = Number.parseInt(el_itemCountHiddenField.value) || 0;
        if (js_product_list_box.scrollWidth && el_currentActive.clientWidth) {
            nb_scrollTo = el_currentActive.clientWidth / 2 + 16
        }

        fn_scrollTo(el_productListBox, nb_scrollTo, 600);
    };


    $(el_header).on('click', function (e) {
        if (e.target.className.includes('js_category_trigger')) {
            return;
        }

        if (e.target.id == 'js_pandaImage' && $(el_header).hasClass('active') == false) {
            $(el_header).addClass('active')
        } else {
            $(el_header).removeClass('active')
        }
    });

    fn_init()

</script>

</html>